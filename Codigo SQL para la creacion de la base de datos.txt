CREATE DATABASE VIDEOJUEGOS_BBDD;
USE VIDEOJUEGOS_BBDD;

CREATE TABLE GENERO(
IDGENERO INTEGER auto_increment  PRIMARY KEY, 
NOMBREGENERO VARCHAR(50) NOT NULL);
 

CREATE TABLE VIDEOJUEGOS 
(IDVIDEOJUEGO INTEGER PRIMARY KEY AUTO_INCREMENT, 
TITULO VARCHAR(200) NOT NULL,
DESCRIPCION TEXT NOT NULL, 
DISTRIBUIDORA VARCHAR(200) NOT NULL, 
PRECIO DOUBLE(9,2),
IMAGEN VARCHAR(255),
IDGENERO INTEGER NOT NULL,
FOREIGN KEY(IDGENERO) REFERENCES GENERO(IDGENERO)
);
 

CREATE TABLE USUARIOS (
USUARIO VARCHAR(50) PRIMARY KEY, 
CONTRASENA VARCHAR(200) NOT NULL,
EMAIL VARCHAR(100)  NOT NULL,
NOMBRE VARCHAR(50), 
APELLIDO VARCHAR(50), 
DIRECCION VARCHAR(100), 
TELEFONO VARCHAR(15), 
DINERO DOUBLE(9,2),
FECHA_ALTA DATE
);

CREATE TABLE PERFIL
(IDPERFIL INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
NOMBRE VARCHAR(50) NOT NULL
);


CREATE TABLE PERFILUSUARIO
(USUARIO VARCHAR(50) NOT NULL,
IDPERFIL INTEGER NOT NULL,
PRIMARY KEY(USUARIO, IDPERFIL),
FOREIGN KEY(USUARIO) REFERENCES USUARIOS(USUARIO),
FOREIGN KEY(IDPERFIL) REFERENCES PERFIL(IDPERFIL)
);

CREATE TABLE COMPRAS
(IDCOMPRA INTEGER UNIQUE AUTO_INCREMENT,
USUARIO VARCHAR(50) NOT NULL,
IDVIDEOJUEGO INTEGER NOT NULL,
ASUNTO VARCHAR(50) NOT NULL,
PRIMARY KEY(IDCOMPRA),
FOREIGN KEY(USUARIO) REFERENCES USUARIOS(USUARIO),
FOREIGN KEY(IDVIDEOJUEGO) REFERENCES VIDEOJUEGOS(IDVIDEOJUEGO)
);


CREATE TABLE VENTAS
(IDVENTA INTEGER UNIQUE AUTO_INCREMENT,
USUARIO VARCHAR(50) NOT NULL,
IDVIDEOJUEGO INTEGER NOT NULL,
ASUNTO VARCHAR(50) NOT NULL,
PRIMARY KEY(IDVENTA),
FOREIGN KEY(USUARIO) REFERENCES USUARIOS(USUARIO),
FOREIGN KEY(IDVIDEOJUEGO) REFERENCES VIDEOJUEGOS(IDVIDEOJUEGO)
);

Si prefieres crear un usuario que solo lo visualice
---------------------------------------------------------------------------------------------

CREATE USER 'uvideojuego'@'localhost' IDENTIFIED BY 'uvideojuego';
GRANT ALL PRIVILEGES ON VIDEOJUEGOS_BBDD.* TO  'uvideojuego'@'localhost';

---------------------------------------------------------------------------------------------
Rellenar tablas

insert into perfil values(1,"Cliente");
insert into perfil values(2,"Propietario");
insert into perfil values(3,"Administrador");